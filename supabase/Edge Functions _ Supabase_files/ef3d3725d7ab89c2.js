;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="b519ad3f-ba91-ba92-01ac-c34ecb6b921b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,687429,e=>{"use strict";var s=e.i(478902),t=e.i(755216),r=e.i(201844),i=e.i(356003),a=e.i(779411),n=e.i(502035),o=e.i(870152),l=e.i(61187),c=e.i(211570),d=e.i(753521);let u=(0,e.i(388019).default)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var h=e.i(975924),m=e.i(215261),x=e.i(4196),p=e.i(389959),f=e.i(591385),g=e.i(355901);e.i(128328);var j=e.i(947748),_=e.i(657588),S=e.i(158639),y=e.i(463333),w=e.i(567558),v=e.i(525070),b=e.i(215312),N=e.i(830495),C=e.i(908027),E=e.i(937942),D=e.i(14703),T=e.i(309233),I=e.i(242882),A=e.i(714403),k=e.i(294285);async function R({projectRef:e,connectionString:s},r){let i=t.default.getIndexWorkerStatusSQL(),{result:a}=await (0,A.executeSql)({projectRef:e,connectionString:s,sql:i,queryKey:["index-worker-status"]},r);return a[0]}var U=e.i(56714);async function L({projectRef:e,connectionString:s},r){let i=t.default.getIndexStatusesSQL(),{result:a}=await (0,A.executeSql)({projectRef:e,connectionString:s,sql:i,queryKey:["index-statuses"]},r);return a}var F=e.i(360608),M=e.i(258732),P=e.i(162082),O=e.i(912793),z=e.i(124416),B=e.i(265735),K=e.i(635494),Q=e.i(48189),H=e.i(178527),$=e.i(206413),q=e.i(592360),X=e.i(837710),V=e.i(843778),G=e.i(248210),W=e.i(725805),Y=e.i(449123),Z=e.i(451031),J=e.i(57492),ee=e.i(831927),es=e.i(156722),et=e.i(719754),er=e.i(613580),ei=e.i(466472),ea=e.i(108151),en=e.i(902858),eo=e.i(88816),el=e.i(906346),ec=e.i(432639),ed=e.i(423782),eu=e.i(2579),eh=e.i(874311),em=e.i(532728),ex=e.i(250503),ep=e.i(408891),ef=e.i(531837),eg=e.i(38429),ej=e.i(234745);async function e_({projectRef:e,user:s}){let{data:t,error:r}=await (0,ej.post)("/platform/auth/{ref}/users",{params:{path:{ref:e}},body:{email:s.email,password:s.password,email_confirm:s.autoConfirmUser}});return r&&(0,ej.handleError)(r),t}var eS=e.i(34411),ey=e.i(253214),ew=e.i(24315),ev=e.i(61863),eb=e.i(191209),eN=e.i(837243),eC=e.i(846887),eE=e.i(428353),eD=e.i(378277);let eT=ef.object({email:ef.string().min(1,"Email is required").email("Must be a valid email address"),password:ef.string().min(1,"Password is required"),autoConfirmUser:ef.boolean()}),eI=({visible:e,setVisible:t})=>{let{ref:r}=(0,S.useParams)(),{can:a}=(0,eu.useAsyncCheckPermissions)(en.PermissionAction.AUTH_EXECUTE,"create_user"),{mutate:n,isPending:o}=(({onSuccess:e,onError:s,...t}={})=>{let r=(0,i.useQueryClient)();return(0,eg.useMutation)({mutationFn:e=>e_(e),async onSuccess(s,t,i){let{projectRef:a}=t;await Promise.all([r.invalidateQueries({queryKey:k.authKeys.usersInfinite(a)}),r.invalidateQueries({queryKey:k.authKeys.usersCount(a)})]),await e?.(s,t,i)},async onError(e,t,r){void 0===s?g.toast.error(`Failed to create user: ${e.message}`):s(e,t,r)},...t})})({onSuccess(e){g.toast.success(`Successfully created user: ${e.email}`),c.reset({email:"",password:"",autoConfirmUser:!0}),t(!1)}}),l=async e=>{if(!r)return console.error("Project ref is required");n({projectRef:r,user:e})},c=(0,ep.useForm)({resolver:(0,em.zodResolver)(eT),defaultValues:{email:"",password:"",autoConfirmUser:!0}});return(0,s.jsx)(ey.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(ey.DialogContent,{size:"small",children:[(0,s.jsx)(ey.DialogHeader,{children:(0,s.jsx)(ey.DialogTitle,{children:"Create a new user"})}),(0,s.jsx)(ey.DialogSectionSeparator,{}),(0,s.jsx)(eE.Form_Shadcn_,{...c,children:(0,s.jsxs)("form",{id:"create-user",className:"flex flex-col gap-y-4 p-6",onSubmit:c.handleSubmit(l),children:[(0,s.jsx)(ev.FormField_Shadcn_,{name:"email",control:c.control,render:({field:e})=>(0,s.jsxs)(eb.FormItem_Shadcn_,{className:"flex flex-col gap-1",children:[(0,s.jsx)(eN.FormLabel_Shadcn_,{children:"Email address"}),(0,s.jsx)(ew.FormControl_Shadcn_,{children:(0,s.jsxs)("div",{className:"items-center relative",children:[(0,s.jsx)(el.Mail,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,s.jsx)(eD.Input_Shadcn_,{autoFocus:!0,...e,autoComplete:"off",type:"email",name:"email",placeholder:"user@example.com",disabled:o,className:"pl-8"})]})}),(0,s.jsx)(eC.FormMessage_Shadcn_,{})]})}),(0,s.jsx)(ev.FormField_Shadcn_,{name:"password",control:c.control,render:({field:e})=>(0,s.jsxs)(eb.FormItem_Shadcn_,{className:"flex flex-col gap-1",children:[(0,s.jsx)(eN.FormLabel_Shadcn_,{children:"User Password"}),(0,s.jsx)(ew.FormControl_Shadcn_,{children:(0,s.jsxs)("div",{className:"items-center relative",children:[(0,s.jsx)(ex.Lock,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,s.jsx)(eD.Input_Shadcn_,{...e,autoComplete:"new-password",type:"password",name:"password",placeholder:"••••••••",disabled:o,className:"pl-8"})]})}),(0,s.jsx)(eC.FormMessage_Shadcn_,{})]})}),(0,s.jsx)(ev.FormField_Shadcn_,{name:"autoConfirmUser",control:c.control,render:({field:e})=>(0,s.jsxs)(eb.FormItem_Shadcn_,{className:"flex items-center gap-x-2",children:[(0,s.jsx)(ew.FormControl_Shadcn_,{children:(0,s.jsx)(eS.Checkbox_Shadcn_,{checked:e.value,onCheckedChange:s=>e.onChange(s)})}),(0,s.jsx)(eN.FormLabel_Shadcn_,{children:"Auto Confirm User?"})]})}),(0,s.jsx)(eN.FormLabel_Shadcn_,{children:(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A confirmation email will not be sent when creating a user via this form."})}),(0,s.jsx)(X.Button,{block:!0,size:"small",htmlType:"submit",loading:o,disabled:!a||o,children:"Create user"})]})})]})})};async function eA({projectRef:e,email:s}){let{data:t,error:r}=await (0,ej.post)("/platform/auth/{ref}/invite",{params:{path:{ref:e}},body:{email:s}});return r&&(0,ej.handleError)(r),t}var ek=e.i(441345),eR=e.i(171997),eU=e.i(40892);let eL=({visible:e,setVisible:t})=>{let{ref:r}=(0,S.useParams)(),{mutate:a,isPending:n}=(({onSuccess:e,onError:s,...t}={})=>{let r=(0,i.useQueryClient)();return(0,eg.useMutation)({mutationFn:e=>eA(e),async onSuccess(s,t,i){let{projectRef:a}=t;await Promise.all([r.invalidateQueries({queryKey:k.authKeys.usersInfinite(a)})]),await e?.(s,t,i)},async onError(e,t,r){void 0===s?g.toast.error(`Failed to invite user: ${e.message}`):s(e,t,r)},...t})})({onSuccess:(e,s)=>{g.toast.success(`Sent invite email to ${s.email}`),t(!1)}}),{can:o}=(0,eu.useAsyncCheckPermissions)(en.PermissionAction.AUTH_EXECUTE,"invite_user"),l=async e=>{if(!r)return console.error("Project ref is required");a({projectRef:r,email:e.email})};return(0,s.jsx)(eU.Modal,{hideFooter:!0,size:"small",visible:e,header:"Invite a new user",onCancel:()=>t(!e),children:(0,s.jsx)(ek.Form,{validateOnBlur:!1,initialValues:{email:""},validate:e=>{let s={};return 0===e.email.length?s.email="Please enter a valid email":/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e.email)||(s.email=`${e.email} is an invalid email`),s},onSubmit:l,children:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eU.Modal.Content,{children:(0,s.jsx)(eR.Input,{id:"email",className:"w-full",label:"User email",icon:(0,s.jsx)(el.Mail,{}),type:"email",name:"email",placeholder:"User email"})}),(0,s.jsx)(eU.Modal.Content,{children:(0,s.jsx)(X.Button,{block:!0,size:"small",htmlType:"submit",loading:n,disabled:!o||n,children:"Invite user"})})]})})},"invite-user-modal")},eF=()=>{let e=(0,O.useIsFeatureEnabled)("authentication:show_send_invitation"),{can:t}=(0,eu.useAsyncCheckPermissions)(en.PermissionAction.AUTH_EXECUTE,"invite_user"),{can:r}=(0,eu.useAsyncCheckPermissions)(en.PermissionAction.AUTH_EXECUTE,"create_user"),[i,a]=(0,x.useQueryState)("invite",x.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),[n,o]=(0,x.useQueryState)("new",x.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(eh.DropdownMenu,{children:[(0,s.jsx)(eh.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(X.Button,{type:"primary",iconRight:(0,s.jsx)(eo.ChevronDown,{size:14,strokeWidth:1.5}),children:"Add user"})}),(0,s.jsxs)(eh.DropdownMenuContent,{side:"bottom",align:"end",className:"w-40",children:[e&&(0,s.jsxs)(ed.DropdownMenuItemTooltip,{className:"gap-x-2",disabled:!t,onClick:()=>{t&&a(!0)},tooltip:{content:{side:"left",text:"You need additional permissions to invite users"}},children:[(0,s.jsx)(el.Mail,{size:14}),(0,s.jsx)("p",{children:"Send invitation"})]}),(0,s.jsxs)(ed.DropdownMenuItemTooltip,{className:"space-x-2 !pointer-events-auto",disabled:!r,onClick:()=>{r&&o(!0)},tooltip:{content:{side:"left",text:"You need additional permissions to create users"}},children:[(0,s.jsx)(ec.UserPlus,{size:14}),(0,s.jsx)("p",{children:"Create new user"})]})]})]}),(0,s.jsx)(eL,{visible:i,setVisible:a}),(0,s.jsx)(eI,{visible:n,setVisible:o})]})};var eM=e.i(875430),eP=e.i(886514),eO=e.i(701257);let ez=({specificFilterColumn:e,sortColumn:t,sortOrder:r,sortByValue:i,showSortByEmail:a,showSortByPhone:n,setSortByValue:o,improvedSearchEnabled:l=!1})=>"freeform"===e||l?(0,s.jsxs)(eh.DropdownMenu,{children:[(0,s.jsx)(eh.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(X.Button,{icon:"desc"===r?(0,s.jsx)(eO.ArrowDownWideNarrow,{}):(0,s.jsx)(eP.ArrowDownNarrowWide,{}),children:["Sorted by ","id"===t?"user ID":t.replaceAll("_"," ")]})}),(0,s.jsx)(eh.DropdownMenuContent,{className:"w-44",align:"start",children:(0,s.jsxs)(eh.DropdownMenuRadioGroup,{value:i,onValueChange:o,children:[(0,s.jsxs)(eh.DropdownMenuSub,{children:[(0,s.jsx)(eh.DropdownMenuSubTrigger,{children:"Sort by user ID"}),(0,s.jsxs)(eh.DropdownMenuSubContent,{children:[(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"id:asc",children:"Ascending"}),(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"id:desc",children:"Descending"})]})]}),(0,s.jsxs)(eh.DropdownMenuSub,{children:[(0,s.jsx)(eh.DropdownMenuSubTrigger,{children:"Sort by created at"}),(0,s.jsxs)(eh.DropdownMenuSubContent,{children:[(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"created_at:asc",children:"Ascending"}),(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"created_at:desc",children:"Descending"})]})]}),(0,s.jsxs)(eh.DropdownMenuSub,{children:[(0,s.jsx)(eh.DropdownMenuSubTrigger,{children:"Sort by last sign in at"}),(0,s.jsxs)(eh.DropdownMenuSubContent,{children:[(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"last_sign_in_at:asc",children:"Ascending"}),(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"last_sign_in_at:desc",children:"Descending"})]})]}),a&&(0,s.jsxs)(eh.DropdownMenuSub,{children:[(0,s.jsx)(eh.DropdownMenuSubTrigger,{children:"Sort by email"}),(0,s.jsxs)(eh.DropdownMenuSubContent,{children:[(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"email:asc",children:"Ascending"}),(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"email:desc",children:"Descending"})]})]}),n&&(0,s.jsxs)(eh.DropdownMenuSub,{children:[(0,s.jsx)(eh.DropdownMenuSubTrigger,{children:"Sort by phone"}),(0,s.jsxs)(eh.DropdownMenuSubContent,{children:[(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"phone:asc",children:"Ascending"}),(0,s.jsx)(eh.DropdownMenuRadioItem,{value:"phone:desc",children:"Descending"})]})]})]})})]}):(0,s.jsx)(b.ButtonTooltip,{disabled:!0,type:"default",icon:(0,s.jsx)(eP.ArrowDownNarrowWide,{}),tooltip:{content:{side:"bottom",className:"w-80 text-center",text:(0,s.jsxs)(s.Fragment,{children:["Sorting cannot be changed when searching on a specific column. If you'd like to sort on other columns, change the search to"," ",(0,s.jsx)("span",{className:"text-warning",children:"unified search"})," from the search dropdown."]})}},children:"Sorted by user ID"}),eB=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;async function eK({projectRef:e,connectionString:s,userId:t},r){if(!t)throw Error("UserID is required");if(!eB.test(t))throw Error("Invalid user ID format");let i=`
select
  auth.users.id,
  auth.users.email,
  auth.users.banned_until,
  auth.users.created_at,
  auth.users.confirmed_at,
  auth.users.confirmation_sent_at,
  auth.users.is_anonymous,
  auth.users.is_sso_user,
  auth.users.invited_at,
  auth.users.last_sign_in_at,
  auth.users.phone,
  auth.users.raw_app_meta_data,
  auth.users.raw_user_meta_data,
  auth.users.updated_at,
  coalesce(
    (
      select
        array_agg(distinct i.provider)
      from
        auth.identities i
      where
        i.user_id = users.id
    ),
    '{}'::text[]
  ) as providers
from
  auth.users
where id = '${t}';
`.trim(),{result:a}=await (0,A.executeSql)({projectRef:e,connectionString:s,sql:i,queryKey:[`user-${t}`]},r);return a[0]}var eQ=e.i(200243),eH=e.i(500850),e$=e.i(283606),eq=e.i(314805),eX=e.i(408279),eV=e.i(17203),eG=e.i(993394),eW=e.i(450049),eY=e.i(281192),eZ=e.i(877555),eJ=e.i(479095),e0=e.i(710483),e1=e.i(955909),e2=e.i(795238),e4=e.i(54592);let e5=({user:e})=>{let{ref:t}=(0,S.useParams)(),{filters:r,setFilters:i}=(0,eY.useLogsUrlState)(),[a,n]=(0,x.useQueryState)("f"),{logData:o,isSuccess:c,isLoading:d,refresh:u}=(0,eW.default)({projectRef:t,table:eG.LOGS_TABLES.auth,filterOverride:{search_query:e.id},limit:5});return(0,p.useEffect)(()=>(e.id&&i({...r,search_query:e.id}),()=>{n(null)}),[e.id]),(0,s.jsxs)("div",{children:[(0,s.jsx)(e2.UserHeader,{user:e}),(0,s.jsx)(eJ.Separator,{}),(0,s.jsxs)("div",{className:(0,V.cn)("flex flex-col gap-y-3",e4.PANEL_PADDING),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Authentication logs"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Latest logs from authentication for this user in the past hour"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(X.Button,{type:"status_code"in r?"default":"secondary",className:"rounded-r-none border-r-0",disabled:d,onClick:()=>i({search_query:e.id}),children:"Show all"}),(0,s.jsx)("div",{className:"border-button border border-l-0 py-3"}),(0,s.jsx)(X.Button,{type:"status_code"in r?"secondary":"default",className:"rounded-l-none border-l-0",disabled:d,onClick:()=>i({search_query:e.id,status_code:{client_error:!0,server_error:!0}}),children:"Error only"})]}),(0,s.jsx)(X.Button,{type:"default",loading:d,disabled:d,icon:(0,s.jsx)(l.RefreshCw,{}),onClick:()=>u(),children:"Refresh"})]}),d&&!c?(0,s.jsx)(ea.GenericSkeletonLoader,{}):0===o.length?(0,s.jsx)(e0.Admonition,{type:"note",title:"No authentication logs available for this user",description:"Auth events such as logging in will be shown here"}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"border border-b-0 rounded-t-md divide-y overflow-hidden",children:o.map(e=>{let r=(e.status??"-").toString(),i=r.startsWith("4"),a=r.startsWith("5");return(0,s.jsxs)("div",{className:"flex items-center transition font-mono px-2 py-1.5 bg-surface-100 divide-x",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light min-w-[125px] w-[125px] px-1",children:(0,s.jsx)(e1.TimestampInfo,{utcTimestamp:e.timestamp/1e3})}),(0,s.jsx)("div",{className:"flex items-center text-xs text-foreground-light h-[22px] min-w-[70px] w-[70px] px-2",children:(0,s.jsxs)("div",{className:(0,V.cn)("flex items-center justify-center gap-x-1",!!e.status&&"border px-1 py-0.5 rounded",i?"text-warning border-warning bg-warning-300":a?"text-destructive border-destructive bg-destructive-300":""),children:[(i||a)&&(0,s.jsx)(eZ.CriticalIcon,{hideBackground:!0,className:(0,V.cn)(i&&"text-warning")}),r]})}),(0,s.jsxs)("p",{className:"group relative flex items-center py-1.5 text-xs text-foreground-light px-2 truncate w-full",children:[`${e.path} | ${e.msg}`,(0,s.jsx)(b.ButtonTooltip,{type:"outline",asChild:!0,tooltip:{content:{text:"Open in logs"}},className:"px-1.5 absolute right-0 top-0 opacity-0 group-hover:opacity-100 transition bg-background focus-visible:opacity-100",children:(0,s.jsx)(m.default,{href:`/project/${t}/logs/auth-logs?log=${e.id}`,children:(0,s.jsx)(eV.ExternalLink,{size:"12",className:"text-foreground-light"})})})]})]},e.id)})}),(0,s.jsx)(X.Button,{block:!0,asChild:!0,type:"outline",className:"transition rounded-t-none text-foreground-light hover:text-foreground",children:(0,s.jsx)(m.default,{href:`/project/${t}/logs/auth-logs?s=${e.id}`,children:"See more logs"})})]})]})]})};var e3=e.i(101385);let e8=()=>{let{data:e}=(0,K.useSelectedProjectQuery)(),[t,r]=(0,x.useQueryState)("show",x.parseAsString.withOptions({history:"push",clearOnDefault:!0})),[i,a]=(0,p.useState)("overview"),[n,o]=(0,p.useState)(""),{data:l,isPending:c}=(({projectRef:e,connectionString:s,userId:t},{enabled:r=!0,...i}={})=>(0,I.useQuery)({queryKey:k.authKeys.user(e,t),queryFn:({signal:r})=>eK({projectRef:e,connectionString:s,userId:t},r),enabled:r&&void 0!==e,...i}))({projectRef:e?.ref,connectionString:e?.connectionString,userId:t}),d=l?Object.entries(l).filter(([e,s])=>e.toLowerCase().includes(n.toLowerCase())||"string"==typeof s&&s.toLowerCase().includes(n.toLowerCase())).reduce((e,[s,t])=>(void 0!==t&&(e[s]=t),e),{}):{};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W.ResizableHandle,{withHandle:!0}),(0,s.jsxs)(W.ResizablePanel,{defaultSize:30,maxSize:45,minSize:30,className:"bg-studio border-t",children:[(0,s.jsx)(X.Button,{type:"text",className:"absolute top-3 right-3 px-1",icon:(0,s.jsx)(h.X,{}),onClick:()=>r(null)}),(0,s.jsx)(eH.Tabs_Shadcn_,{value:i,className:"flex flex-col h-full",onValueChange:e=>a(e),children:c?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"min-h-[46px] border-b"}),(0,s.jsx)("div",{className:"p-5",children:(0,s.jsx)(ea.GenericSkeletonLoader,{})})]}):l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(eq.TabsList_Shadcn_,{className:"px-5 flex gap-x-4 min-h-[46px]",children:[(0,s.jsx)(eX.TabsTrigger_Shadcn_,{value:"overview",className:"px-0 pb-0 h-full text-xs  data-[state=active]:bg-transparent !shadow-none",children:"Overview"}),(0,s.jsx)(eX.TabsTrigger_Shadcn_,{value:"logs",className:"px-0 pb-0 h-full text-xs data-[state=active]:bg-transparent !shadow-none",children:"Logs"}),(0,s.jsx)(eX.TabsTrigger_Shadcn_,{value:"raw",className:"px-0 pb-0 h-full text-xs data-[state=active]:bg-transparent !shadow-none",children:"Raw JSON"})]}),(0,s.jsx)(e$.TabsContent_Shadcn_,{value:"overview",className:(0,V.cn)("mt-0 flex-grow min-h-0 overflow-y-auto"),children:l&&(0,s.jsx)(e3.UserOverview,{user:l,onDeleteSuccess:()=>r(null)})}),(0,s.jsx)(e$.TabsContent_Shadcn_,{value:"logs",className:(0,V.cn)("mt-0 flex-grow min-h-0 overflow-y-auto"),children:l&&(0,s.jsx)(e5,{user:l})}),(0,s.jsxs)(e$.TabsContent_Shadcn_,{value:"raw",className:(0,V.cn)("mt-0 flex-grow min-h-0 overflow-y-auto",e4.PANEL_PADDING),children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)(eD.Input_Shadcn_,{autoFocus:!0,type:"text",placeholder:"Filter...",value:n,onChange:e=>o(e.target.value),className:"mr-2"}),(0,s.jsx)(X.Button,{type:"text",disabled:!n,onClick:()=>o(""),className:"text-xs",children:"Clear"})]}),(0,s.jsx)(eQ.SimpleCodeBlock,{className:"javascript",parentClassName:"[&>*>span]:text-xs",children:JSON.stringify(d,null,2)})]})]}):(0,s.jsxs)("div",{className:"flex items-center justify-center w-full h-full flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Unable to find user with the following ID in project"}),(0,s.jsxs)("p",{className:"text-foreground-lighter text-xs",children:["ID: ",t]})]})})]})]})};var e7=e.i(71011),e9=e.i(899850),e6=e.i(382490),se=e.i(774803),ss=e.i(526925);let st=({filter:e,filterKeywords:t,selectedProviders:i,specificFilterColumn:a})=>{let{ref:n}=(0,S.useParams)(),{data:o}=(0,K.useSelectedProjectQuery)(),[l,c]=(0,p.useState)(!1),[d,u]=(0,p.useState)(!1),{data:h,isPending:m,isFetching:x,isSuccess:f}=(0,F.useUsersCountQuery)({projectRef:n,connectionString:o?.connectionString,keywords:t,filter:"all"===e?void 0:e,providers:i,forceExactCount:l,..."freeform"!==a?{column:a}:{column:void 0}},{placeholderData:r.keepPreviousData}),g=h?.count??0;return(0,p.useEffect)(()=>{f&&"freeform"===a&&c(h.is_estimate&&h.count<=e9.THRESHOLD_COUNT)},[f,a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-between min-h-9 h-9 overflow-hidden items-center px-6 w-full border-t text-xs text-foreground-light",children:(0,s.jsx)("div",{className:"flex items-center gap-x-2",children:m||x||void 0===h?(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(se.Loader2,{size:14,className:"animate-spin"})," Loading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Total:"," ",h?.is_estimate?(0,ss.formatEstimatedCount)(g):g.toLocaleString()," ","user",1!==g?"s":"",h?.is_estimate&&" (estimated)"]}),h?.is_estimate&&(0,s.jsxs)(er.Tooltip,{children:[(0,s.jsx)(er.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(X.Button,{size:"tiny",type:"text",className:"px-1.5",icon:(0,s.jsx)(e6.HelpCircle,{}),onClick:()=>{"freeform"===a&&u(!0)}})}),(0,s.jsx)(er.TooltipContent,{side:"top",className:"w-80",children:"freeform"===a?(0,s.jsxs)(s.Fragment,{children:["This is an estimated value as your project has more than"," ",e9.THRESHOLD_COUNT.toLocaleString()," users.",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count."})," "]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"mb-1",children:"This is an estimated value which may not be accurate."}),(0,s.jsxs)("p",{children:["If you'd like to retrieve the exact count, change the search to"," ",(0,s.jsx)("span",{className:"text-warning",children:"all columns"})," from the header."]})," "]})})]})]})})}),(0,s.jsx)(ei.default,{variant:"warning",visible:d,title:"Fetch exact user count",confirmLabel:"Fetch exact count",onCancel:()=>u(!1),onConfirm:()=>{c(!0),u(!1)},children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Your project has more than ",e9.THRESHOLD_COUNT.toLocaleString()," users, and fetching the exact count may cause performance issues on your database."]})})]})};var sr=e.i(366652),si=e.i(843142),sa=e.i(746301);let sn=({search:e,searchInvalid:t,specificFilterColumn:r,setSearch:i,setFilterKeywords:a,setSpecificFilterColumn:n,improvedSearchEnabled:o=!1})=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-xs h-[26px] flex items-center px-1.5 border border-strong rounded-l-md bg-surface-300",children:(0,s.jsx)(sr.Search,{size:14})}),(0,s.jsxs)(Y.Select_Shadcn_,{value:r,onValueChange:e=>n(e),children:[(0,s.jsx)(es.SelectTrigger_Shadcn_,{size:"tiny",className:(0,V.cn)("w-[130px] !bg-transparent rounded-none -ml-[1px]","freeform"===r&&"text-warning"),children:(0,s.jsx)(et.SelectValue_Shadcn_,{})}),(0,s.jsx)(Z.SelectContent_Shadcn_,{children:(0,s.jsxs)(J.SelectGroup_Shadcn_,{children:[(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"id",className:"text-xs",children:"User ID"}),(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"email",className:"text-xs",children:"Email address"}),o&&(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"name",className:"text-xs",children:"Name"}),(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"phone",className:"text-xs",children:"Phone number"}),!o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(si.SelectSeparator_Shadcn_,{}),(0,s.jsxs)(er.Tooltip,{children:[(0,s.jsx)(er.TooltipTrigger,{children:(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"freeform",className:"text-xs",children:"Unified search"})}),(0,s.jsx)(er.TooltipContent,{side:"right",className:"w-64 text-center",children:"Search by all columns at once, including mid-string search. May impact database performance if you have many users."})]})]})]})})]}),(0,s.jsx)(sa.Input,{size:"tiny",className:(0,V.cn)("w-[245px] bg-transparent rounded-l-none -ml-[1px]",t?"text-red-900 dark:border-red-900":"",e.length>1&&"pr-6"),placeholder:(e=>{switch(e){case"id":return"Search by user ID";case"email":return"Search by email";case"name":return"Search by name";case"phone":return"Search by phone";case"freeform":return"Search by user ID, email, phone or name";default:return"Search users..."}})(r),value:e,onChange:e=>{i(e.target.value.replace(/\s+/g,"").toLowerCase())},onKeyDown:s=>{"Enter"!==s.code&&"NumpadEnter"!==s.code||t||a(e.trim().toLocaleLowerCase())},actions:e?(0,s.jsx)(X.Button,{size:"tiny",type:"text",className:"p-0 h-5 w-5",icon:(0,s.jsx)(h.X,{className:(0,V.cn)(t?"text-red-900":"")}),onClick:()=>{i(""),a("")}}):null})]}),so=`select id, auth_logs.timestamp, metadata.level, event_message, metadata.msg as msg, metadata.error
from auth_logs
cross join unnest(metadata) as metadata
where metadata.worker_type = 'apiworker_index_worker'
  and auth_logs.timestamp >= timestamp_sub(current_timestamp(), interval 3 hour)
order by timestamp desc
limit 100`,sl=()=>{let e=(0,i.useQueryClient)(),{ref:A}=(0,S.useParams)(),{data:en}=(0,K.useSelectedProjectQuery)(),{data:eo}=(0,B.useSelectedOrganizationQuery)(),el=(0,p.useRef)(null),ec=(0,p.useRef)(0),ed=(0,y.useIsAPIDocsSidePanelEnabled)(),{mutate:eu}=(0,P.useSendEventMutation)(),{authenticationShowProviderFilter:eh,authenticationShowSortByEmail:em,authenticationShowSortByPhone:ex,authenticationShowUserTypeFilter:ep,authenticationShowEmailPhoneColumns:ef}=(0,O.useIsFeatureEnabled)(["authentication:show_provider_filter","authentication:show_sort_by_email","authentication:show_sort_by_phone","authentication:show_user_type_filter","authentication:show_email_phone_columns"]),eg=(0,p.useMemo)(()=>ef?e4.USERS_TABLE_COLUMNS:e4.USERS_TABLE_COLUMNS.filter(e=>"email"!==e.id&&"phone"!==e.id),[ef]),[ej,e_]=(0,x.useQueryState)("filter",(0,x.parseAsStringEnum)(["id","email","phone","name","freeform"]).withDefault("email")),[eS,ey]=(0,x.useQueryState)("userType",(0,x.parseAsStringEnum)(["all","verified","unverified","anonymous"]).withDefault("all")),[ew,ev]=(0,x.useQueryState)("keywords",{defaultValue:""}),[eb,eN]=(0,x.useQueryState)("sortBy",{defaultValue:"created_at:desc"}),[eC,eE]=eb.split(":"),[eD,eT]=(0,x.useQueryState)("columns",(0,x.parseAsArrayOf)(x.parseAsString,",").withDefault([])),[eI,eA]=(0,x.useQueryState)("providers",(0,x.parseAsArrayOf)(x.parseAsString,",").withDefault([])),[ek,eR]=(0,x.useQueryState)("show",x.parseAsString.withOptions({history:"push",clearOnDefault:!0})),[eU,eL]=(0,z.useLocalStorageQuery)(j.LOCAL_STORAGE_KEYS.AUTH_USERS_IMPROVED_SEARCH_DISMISSED(A??""),!1),[eP,eO,{isSuccess:eB}]=(0,z.useLocalStorageQuery)(j.LOCAL_STORAGE_KEYS.AUTH_USERS_FILTER(A??""),"email"),[eK,eQ,{isSuccess:eH}]=(0,z.useLocalStorageQuery)(j.LOCAL_STORAGE_KEYS.AUTH_USERS_SORT_BY_VALUE(A??""),"id"),[e$,eq,{isSuccess:eX,isError:eV,error:eG}]=(0,z.useLocalStorageQuery)(j.LOCAL_STORAGE_KEYS.AUTH_USERS_COLUMNS_CONFIGURATION(A??""),null),[eW,eY]=(0,p.useState)([]),[eZ,eJ]=(0,p.useState)(ew),[e0,e1]=(0,p.useState)(new Set([])),[e2,e5]=(0,p.useState)(),[e3,e9]=(0,p.useState)(!1),[e6,se]=(0,p.useState)(!1),[ss,sr]=(0,p.useState)(!1),[si,sa]=(0,p.useState)(!1),{data:sl,isSuccess:sc}=(0,F.useUsersCountQuery)({projectRef:A,connectionString:en?.connectionString,keywords:"",filter:void 0,providers:[],forceExactCount:!1},{placeholderData:r.keepPreviousData}),sd=sl?.count??0,su=sd<=1e4,sh=(0,_.useFlag)("improvedUserSearch"),{data:sm,isLoading:sx}=(0,D.useAuthConfigQuery)({projectRef:A}),{data:sp,isError:sf,isLoading:sg}=(({projectRef:e,connectionString:s},{enabled:t=!0,...r}={})=>(0,I.useQuery)({queryKey:k.authKeys.usersIndexStatuses(e),queryFn:({signal:t})=>L({projectRef:e,connectionString:s},t),enabled:t&&void 0!==e,...r}))({projectRef:A,connectionString:en?.connectionString}),{data:sj,isLoading:s_}=(({projectRef:e,connectionString:s},{enabled:t=!0,...r}={})=>(0,I.useQuery)({queryKey:k.authKeys.indexWorkerStatus(e),queryFn:({signal:t})=>R({projectRef:e,connectionString:s},t),enabled:t&&void 0!==e,...r}))({projectRef:A,connectionString:en?.connectionString}),{mutate:sS,isPending:sy}=(0,T.useAuthConfigUpdateMutation)({onSuccess:()=>{g.toast.success("Initiated creation of user search indexes")},onError:e=>{g.toast.error(`Failed to initiate creation of user search indexes: ${e?.message}`)}}),sw=!sf&&!sg&&sp?.length===t.default.USER_SEARCH_INDEXES.length&&sp?.every(e=>e.is_valid&&e.is_ready),sv=sh&&sm?.INDEX_WORKER_ENSURE_USER_SEARCH_INDEXES_EXIST===!0&&sw,sb=sh&&sm?.INDEX_WORKER_ENSURE_USER_SEARCH_INDEXES_EXIST===!1&&sc&&sd<=1e4&&!eU,sN=sm?.INDEX_WORKER_ENSURE_USER_SEARCH_INDEXES_EXIST===!0&&sj?.is_in_progress===!0,{data:sC,error:sE,isSuccess:sD,isLoading:sT,isRefetching:sI,isError:sA,isFetchingNextPage:sk,refetch:sR,hasNextPage:sU,fetchNextPage:sL}=(0,M.useUsersInfiniteQuery)({projectRef:A,connectionString:en?.connectionString,keywords:ew,filter:("freeform"===ej||sv)&&"all"!==eS?eS:void 0,providers:eI,sort:eC,order:eE,..."freeform"!==ej||sv?{column:ej}:{column:void 0},improvedSearchEnabled:sv},{placeholderData:ew?r.keepPreviousData:void 0,staleTime:1/0,enabled:!sg&&!sx&&!s_}),{mutateAsync:sF}=(0,U.useUserDeleteMutation)(),sM=(0,p.useMemo)(()=>sC?.pages.flatMap(e=>e.result)??[],[sC?.pages]),sP=sM?.find(e=>e.id===ek)?.id,sO=sM.find(e=>e.id===[...e0][0]),sz=!!eZ&&"freeform"!==ej&&"email"!==ej&&"name"!==ej&&("id"===ej?!eZ.match(e4.UUIDV4_LEFT_PREFIX_REGEX):!eZ.match(e4.PHONE_NUMBER_LEFT_PREFIX_REGEX)),sB={sort_column:eC,sort_order:eE,providers:eI,user_type:"all"===eS?void 0:eS,keywords:ew,filter_column:"freeform"===ej?void 0:ej},sK={project:A??"Unknown",organization:eo?.slug??"Unknown"},sQ=e=>{eO(e),e_(e),"freeform"===e||sv||sH("id:asc")},sH=e=>{su&&eQ(e),eN(e)},s$=(0,a.default)((e,s)=>{"toggle"===e?eq(s.columns.map(e=>({id:e.key,width:e.width}))):"resize"===e?eq(eW.map((e,t)=>({id:e.key,width:t===s.idx?s.width:e.width}))):"reorder"===e&&eq(s.columns.map(e=>({id:e.key,width:e.width})))},500),sq=async()=>{if(!A)return console.error("Project ref is required");let s=[...e0];se(!0);try{await Promise.all(s.map(e=>sF({projectRef:A,userId:e,skipInvalidation:!0}))),await Promise.all([e.invalidateQueries({queryKey:k.authKeys.usersInfinite(A)})]),g.toast.success(`Successfully deleted the selected ${e0.size} user${e0.size>1?"s":""}`),e9(!1),e1(new Set([])),s.includes(sP)&&eR(null)}catch(e){g.toast.error(`Failed to delete selected users: ${e.message}`)}finally{se(!1)}};return(0,p.useEffect)(()=>{if(!sI&&(eX||eV&&eG.message.includes("data is undefined"))){let e=(0,e7.formatUserColumns)({specificFilterColumn:ej,columns:eg,config:e$??[],users:sM??[],visibleColumns:eD,setSortByValue:sH,onSelectDeleteUser:e5});eY(e),e.length<eg.length&&eT(e.filter(e=>"img"!==e.key).map(e=>e.key))}},[sD,sI,eX,eV,eG,sM,e0,ej]),(0,p.useEffect)(()=>{eB&&eH&&sc&&su&&("email"===ej&&"email"!==eP&&e_(eP),"id:asc"===eb&&"id:asc"!==eK&&eN(eK))},[eB,eH,sc]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsx)(C.FormHeader,{className:"py-4 px-6 !mb-0",title:"Users"}),sb&&(0,s.jsxs)(H.Alert_Shadcn_,{className:"rounded-none mb-0 border-0 border-t relative",children:[(0,s.jsxs)(er.Tooltip,{children:[(0,s.jsx)(er.TooltipTrigger,{onClick:()=>eL(!0),className:"absolute top-3 right-3 opacity-30 hover:opacity-100 transition-opacity",children:(0,s.jsx)(h.X,{size:14,className:"text-foreground-light"})}),(0,s.jsx)(er.TooltipContent,{side:"bottom",children:"Dismiss"})]}),(0,s.jsx)(o.InfoIcon,{className:"size-4"}),(0,s.jsx)(q.AlertTitle_Shadcn_,{children:"Upgrade to an improved search experience"}),(0,s.jsxs)($.AlertDescription_Shadcn_,{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{children:"Enable faster and more reliable searching, sorting, and filtering of your users."}),(0,s.jsx)(X.Button,{icon:(0,s.jsx)(u,{}),onClick:()=>sa(!0),loading:sy,type:"default",children:"Upgrade search"})]})]}),sN&&(0,s.jsxs)(H.Alert_Shadcn_,{className:"rounded-none mb-0 border-0 border-t",children:[(0,s.jsx)(o.InfoIcon,{className:"size-4"}),(0,s.jsx)(q.AlertTitle_Shadcn_,{children:"Index creation is in progress"}),(0,s.jsxs)($.AlertDescription_Shadcn_,{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{children:"The indexes are currently being created. This process may take some time depending on the number of users in your project."}),(0,s.jsx)(X.Button,{type:"link",iconRight:(0,s.jsx)(n.ExternalLinkIcon,{}),asChild:!0,children:(0,s.jsx)(m.default,{href:`/project/${A}/logs/explorer?q=${encodeURI(so)}`,target:"_blank",children:"View logs"})})]})]}),(0,s.jsx)("div",{className:"bg-surface-200 py-3 px-4 md:px-6 flex flex-col lg:flex-row lg:items-start justify-between gap-2 border-t",children:e0.size>0?(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsxs)(X.Button,{type:"default",icon:(0,s.jsx)(c.Trash,{}),onClick:()=>e9(!0),children:["Delete ",e0.size," users"]}),(0,s.jsx)(b.ButtonTooltip,{type:"default",icon:(0,s.jsx)(h.X,{}),className:"px-1.5",onClick:()=>e1(new Set([])),tooltip:{content:{side:"bottom",text:"Cancel selection"}}})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)(sn,{search:eZ,searchInvalid:sz,specificFilterColumn:ej,setSearch:eJ,setFilterKeywords:e=>{ev(e),eR(null),eu({action:"auth_users_search_submitted",properties:{trigger:"search_input",...sB,keywords:e},groups:sK})},setSpecificFilterColumn:e=>{"freeform"===e?su?sQ(e):sr(!0):sQ(e)},improvedSearchEnabled:sv}),ep&&("freeform"===ej||sv)&&(0,s.jsxs)(Y.Select_Shadcn_,{value:eS,onValueChange:e=>{ey(e),eu({action:"auth_users_search_submitted",properties:{trigger:"user_type_filter",...sB,user_type:e},groups:sK})},children:[(0,s.jsx)(es.SelectTrigger_Shadcn_,{size:"tiny",className:(0,V.cn)("w-[140px] !bg-transparent","all"===eS&&"border-dashed"),children:(0,s.jsx)(et.SelectValue_Shadcn_,{})}),(0,s.jsx)(Z.SelectContent_Shadcn_,{children:(0,s.jsxs)(J.SelectGroup_Shadcn_,{children:[(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"all",className:"text-xs",children:"All users"}),(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"verified",className:"text-xs",children:"Verified users"}),(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"unverified",className:"text-xs",children:"Unverified users"}),(0,s.jsx)(ee.SelectItem_Shadcn_,{value:"anonymous",className:"text-xs",children:"Anonymous users"})]})})]}),eh&&("freeform"===ej||sv)&&(0,s.jsx)(N.FilterPopover,{name:"Provider",options:e4.PROVIDER_FILTER_OPTIONS,labelKey:"name",valueKey:"value",iconKey:"icon",activeOptions:eI,labelClass:"text-xs",maxHeightClass:"h-[190px]",className:"w-52",onSaveFilters:e=>{eA(e),eu({action:"auth_users_search_submitted",properties:{trigger:"provider_filter",...sB,providers:e},groups:sK})}}),(0,s.jsx)("div",{className:"border-r border-strong h-6"}),(0,s.jsx)(N.FilterPopover,{name:0===eD.length?"All columns":"Columns",title:"Select columns to show",buttonType:0===eD.length?"dashed":"default",options:eg.slice(1),labelKey:"name",valueKey:"id",labelClass:"text-xs",maxHeightClass:"h-[190px]",clearButtonText:"Reset",activeOptions:eD,onSaveFilters:e=>{let s=(e$??[]).slice();0===e.length?s=eg.map(e=>({id:e.id,width:e.width})):e.forEach(e=>{s.find(s=>s.id===e)||s.push({id:e,width:eg.find(s=>s.id===e)?.width})});let t=(0,e7.formatUserColumns)({specificFilterColumn:ej,columns:eg,config:s,users:sM??[],visibleColumns:e,setSortByValue:sH,onSelectDeleteUser:e5});eT(e),eY(t),s$("toggle",{columns:t})}}),(0,s.jsx)(ez,{specificFilterColumn:ej,sortColumn:eC,sortOrder:eE,sortByValue:eb,setSortByValue:e=>{let[s,t]=e.split(":");sH(e),eu({action:"auth_users_search_submitted",properties:{trigger:"sort_change",...sB,sort_column:s,sort_order:t},groups:sK})},showSortByEmail:em,showSortByPhone:ex,improvedSearchEnabled:sv})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[ed&&(0,s.jsx)(v.APIDocsButton,{section:["user-management"],source:"auth-users"}),(0,s.jsx)(b.ButtonTooltip,{size:"tiny",icon:(0,s.jsx)(l.RefreshCw,{}),type:"default",className:"w-7",loading:sI&&!sk,onClick:()=>{sR(),eu({action:"auth_users_search_submitted",properties:{trigger:"refresh_button",...sB},groups:sK})},tooltip:{content:{side:"bottom",text:"Refresh"}}}),(0,s.jsx)(eF,{})]})]})}),(0,s.jsx)(G.LoadingLine,{loading:sT||sI||sk}),(0,s.jsxs)(W.ResizablePanelGroup,{direction:"horizontal",className:"relative flex flex-grow bg-alternative min-h-0",autoSaveId:"query-performance-layout-v1",children:[(0,s.jsx)(W.ResizablePanel,{defaultSize:1,children:(0,s.jsx)("div",{className:"flex flex-col w-full h-full",children:(0,s.jsx)(f.default,{ref:el,className:"flex-grow border-t-0",rowHeight:44,headerRowHeight:36,columns:eW,rows:(0,e7.formatUsersData)(sM??[]),rowClass:e=>{let s=e.id===sP;return`${s?"bg-surface-300 dark:bg-surface-300":"bg-200"} cursor-pointer [&>.rdg-cell]:border-box [&>.rdg-cell]:outline-none [&>.rdg-cell]:shadow-none [&>.rdg-cell:first-child>div]:ml-4`},rowKeyGetter:e=>e.id,selectedRows:e0,onScroll:e=>{let s=ec.current!==e.currentTarget.scrollLeft;ec.current=e.currentTarget.scrollLeft,!sT&&!sk&&!s&&(0,Q.isAtBottom)(e)&&sU&&sL()},onSelectedRowsChange:e=>{e.size>e4.MAX_BULK_DELETE?(0,g.toast)(`Only up to ${e4.MAX_BULK_DELETE} users can be selected at a time`):e1(e)},onColumnResize:(e,s)=>s$("resize",{idx:e,width:s}),onColumnsReorder:(e,s)=>{let t=eW.findIndex(s=>s.key===e),r=eW.findIndex(e=>e.key===s),i=((e,s,t)=>{let r=e.slice(),[i]=r.splice(s,1);return r.splice(t,0,i),r})(eW,t,r);eY(i),s$("reorder",{columns:i})},renderers:{renderRow:(e,t)=>(0,s.jsx)(f.Row,{...t,onClick:()=>{let s=sM.find(s=>s.id===e);if(s){let e=sM.indexOf(s);t.row.id&&(eR(t.row.id),el.current?.scrollToCell({idx:0,rowIdx:e}))}}}),noRowsFallback:sT?(0,s.jsx)("div",{className:"absolute top-14 px-6 w-full",children:(0,s.jsx)(ea.GenericSkeletonLoader,{})}):sA?(0,s.jsx)("div",{className:"absolute top-14 px-6 flex flex-col items-center justify-center w-full",children:(0,s.jsx)(w.AlertError,{subject:"Failed to retrieve users",error:sE})}):(0,s.jsxs)("div",{className:"absolute top-20 px-6 flex flex-col items-center justify-center w-full gap-y-2",children:[(0,s.jsx)(d.Users,{className:"text-foreground-lighter",strokeWidth:1}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-foreground",children:"all"!==eS||ew.length>0?"No users found":"No users in your project"}),(0,s.jsx)("p",{className:"text-foreground-light",children:"all"!==eS||ew.length>0?"There are currently no users based on the filters applied":"There are currently no users who signed up to your project"})]})]})}})})}),!!ek&&(0,s.jsx)(e8,{})]}),(0,s.jsx)(st,{filter:eS,filterKeywords:ew,selectedProviders:eI,specificFilterColumn:ej})]}),(0,s.jsx)(ei.default,{visible:e3,variant:"destructive",title:`Confirm to delete ${e0.size} user${e0.size>1?"s":""}`,loading:e6,confirmLabel:"Delete",onCancel:()=>e9(!1),onConfirm:()=>sq(),alert:{title:`Deleting ${1===e0.size?"a user":"users"} is irreversible`,description:`This will remove the selected ${1===e0.size?"":`${e0.size} `}user${e0.size>1?"s":""} from the project and all associated data.`},children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the"," ",1===e0.size?"":`selected ${e0.size} `,"user",e0.size>1?"s":"",1===e0.size?(0,s.jsxs)("span",{className:"text-foreground",children:[" ",sO?.email??sO?.phone??"this user"]}):null,"?"]})}),(0,s.jsx)(ei.default,{size:"medium",variant:"warning",visible:ss,confirmLabel:"Confirm",title:"Confirm to search across all columns",onConfirm:()=>{sQ("freeform"),sr(!1)},onCancel:()=>sr(!1),alert:{base:{variant:"warning"},title:"Searching across all columns is not recommended with many users",description:"This may adversely impact your database, in particular if your project has a large number of users - use with caution. Search mode will not be persisted across browser sessions as a safeguard."},children:(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"This will allow you to search across user ID, email, phone number, and display name through a single input field. You will also be able to filter users by provider and sort on users across different columns."})}),(0,s.jsx)(ei.default,{size:"medium",visible:si,confirmLabel:"Upgrade search",title:"Upgrade to improved search",onConfirm:()=>{(()=>{if(!A)return console.error("Project ref is required");sS({projectRef:A,config:{INDEX_WORKER_ENSURE_USER_SEARCH_INDEXES_EXIST:!0}})})(),sa(!1)},onCancel:()=>sa(!1),alert:{title:"Improved search experience",description:"This will create indexes to enable faster and more reliable searching, sorting, and filtering of your users."},children:(0,s.jsxs)("ul",{className:"text-sm list-disc pl-4 my-3 flex flex-col gap-2",children:[(0,s.jsx)("li",{className:"marker:text-foreground-light",children:"Creating these indexes may temporarily impact database performance."}),(0,s.jsx)("li",{className:"marker:text-foreground-light",children:"Depending on the number of users, this may take some time to complete."}),(0,s.jsx)("li",{className:"marker:text-foreground-light",children:"You can continue using the Auth Users page while the indexes are being created, but improvements will only take effect once complete."}),(0,s.jsxs)("li",{className:"marker:text-foreground-light",children:["You can monitor the progress in the"," ",(0,s.jsx)(E.InlineLink,{href:`/project/${A}/logs/explorer?q=${encodeURI(so)}`,target:"_blank",children:"project logs"}),". If you encounter any issues, please contact Supabase support for assistance."]})]})}),(0,s.jsx)(eM.DeleteUserModal,{visible:!!e2,selectedUser:e2,onClose:()=>{e5(void 0),(0,Q.cleanPointerEventsNoneOnBody)()},onDeleteSuccess:()=>{e2?.id===sP&&eR(null),e5(void 0),(0,Q.cleanPointerEventsNoneOnBody)(500)}})]})};var sc=e.i(785951),sd=e.i(448710);let su=()=>(0,s.jsx)(sl,{});su.getLayout=e=>(0,s.jsx)(sd.default,{children:(0,s.jsx)(sc.default,{children:e})}),e.s(["default",0,su],687429)},382624,(e,s,t)=>{let r="/project/[ref]/auth/users";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(687429)]),s.hot&&s.hot.dispose(function(){window.__NEXT_P.push([r])})}]);

//# debugId=b519ad3f-ba91-ba92-01ac-c34ecb6b921b
//# sourceMappingURL=5df53f61cf7693de.js.map