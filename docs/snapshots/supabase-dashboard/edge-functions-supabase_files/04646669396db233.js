;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="1b329996-145e-e618-a657-c7c893e22f3c")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,958803,e=>{"use strict";let t;var s,r=e.i(478902),a=e.i(817729),i=e.i(774803),n=e.i(953197),l=e.i(215261),o=e.i(389959),c=e.i(310474),u=e.i(355901),d=e.i(223600),h=e.i(811025),p=e.i(242882),g=e.i(10429);async function m(e){let t=await fetch(`${g.BASE_PATH}/api/incident-status`,{signal:e,method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw console.error("[getIncidentStatus] Failed:",t.status,e),Error(`Failed to fetch incident status: ${t.statusText}`)}return await t.json()}let x=(e={})=>(0,p.useQuery)({queryKey:["platform","incident-status"],queryFn:({signal:e})=>m(e),staleTime:3e5,...e});var f=e.i(234745);async function j(e){let{data:t,error:s}=await (0,f.get)("/platform/status",{signal:e});return s&&(0,f.handleError)(s),{isHealthy:t.is_healthy}}var y=e.i(162082);function b(e,t,s,r){let a=(0,o.useRef)(e),i=a.current,n=i.type===t&&e.type===s;a.current=e,n&&r(i,e)}var S=e.i(837710),v=e.i(843778),N=e.i(613580),_=e.i(710483),R=e.i(809323),w=e.i(265100),C=e.i(543064),E=e.i(602089),A=e.i(917816);let I=({projectRef:e,organizationSlug:t})=>{let{mutate:s}=(0,y.useSendEventMutation)(),[a,i]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=setTimeout(()=>i(!0),800);return()=>clearTimeout(e)},[]);let n=(0,o.useCallback)(()=>{s({action:"ai_assistant_in_support_form_clicked",groups:{project:null===e||e===A.NO_PROJECT_MARKER?void 0:e,organization:null===t||t===A.NO_ORG_MARKER?void 0:t}})},[e,t,s]),c=`/project/${e!==A.NO_PROJECT_MARKER?e:"_"}?sidebar=ai-assistant&slug=${t}`;return t&&t!==A.NO_ORG_MARKER?(0,r.jsx)(R.AnimatePresence,{children:a&&(0,r.jsx)(w.motion.aside,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"w-full overflow-hidden border rounded-md relative bg-200",children:(0,r.jsxs)("div",{className:"flex items-center p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 z-[2] flex-shrink-0 w-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-foreground",children:"Try Supabase Assistant"}),(0,r.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Ask our AI assistant to help you with your support issue."})]}),(0,r.jsx)("div",{children:(0,r.jsx)(l.default,{href:c,onClick:n,children:(0,r.jsx)(S.Button,{size:"tiny",type:"default",icon:(0,r.jsx)(E.AiIconAnimation,{size:14}),children:"Ask the Assistant"})})})]}),(0,r.jsxs)("div",{className:"absolute z-[1] scale-75 -right-40 md:-right-24 -top-6 md:top-0",children:[(0,r.jsxs)("div",{className:"relative grow flex flex-col gap-3 w-[400px]",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 pl-12",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-background-surface-300 flex items-center justify-center",children:(0,r.jsx)(C.MessageSquare,{size:16,className:"text-foreground-lighter"})}),(0,r.jsx)("div",{className:"flex-1 bg-background-surface-200 rounded-lg p-4 max-w-[280px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Hi! I'm your AI assistant. How can I help you today?"})})]}),(0,r.jsx)("div",{className:"flex items-start justify-end gap-3 pr-10",children:(0,r.jsx)("div",{className:"bg-background-surface-200 rounded-lg p-4 max-w-[280px]",children:(0,r.jsx)("p",{className:"text-sm text-foreground-lighter",children:"I can help you with database queries, API endpoints, or any other technical questions you might have."})})})]}),(0,r.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-l from-transparent via-background-200 via-[90%] to-background-200 to-[100%] z-[1]"})]})]})})}):null};var O=e.i(898452);let k=({organizationSlug:e})=>{let{data:t}=(0,h.useOrganizationsQuery)(),[s,a]=(0,o.useState)(!1),i=t?.find(t=>t.slug===e),n=i?.plan.id==="free";return(0,o.useEffect)(()=>{let e=setTimeout(()=>a(!0),800);return()=>clearTimeout(e)},[]),(0,r.jsx)(R.AnimatePresence,{children:s&&n&&e!==A.NO_ORG_MARKER&&(0,r.jsx)(w.motion.aside,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"w-full overflow-hidden border border-transparent rounded-md relative",style:{background:"#404EED",borderColor:"color-mix(in srgb, #404EED 95%, #000000)"},children:(0,r.jsxs)("div",{className:"flex items-center p-6",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-20 md:opacity-30",style:{backgroundImage:`url(${O.default.basePath}/img/support/discord-bg-small.jpg)`,backgroundSize:"75%",backgroundPosition:"112% 50%",backgroundRepeat:"no-repeat",maskImage:"linear-gradient(to left, rgba(0,0,0,1) 10%, rgba(0,0,0,0) 100%)",WebkitMaskImage:"linear-gradient(to left, rgba(0,0,0,1) 10%, rgba(0,0,0,0) 100%)"}}),(0,r.jsx)("div",{className:"relative z-10",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-white",children:"Ask the Discord community"}),(0,r.jsx)("p",{className:"text-sm text-white/75",children:"Many code-related questions are answered within minutes."})]}),(0,r.jsx)(l.default,{href:"https://discord.supabase.com",target:"_blank",rel:"noreferrer",children:(0,r.jsx)(S.Button,{size:"tiny",type:"secondary",icon:(0,r.jsx)(c.default,{src:`${O.default.basePath}/img/discord-icon.svg`,className:"h-4 w-4"}),className:"bg-white hover:bg-white/90",children:(0,r.jsx)("span",{style:{color:"#404EED"},children:"Ask on Discord"})})})]})})]})})})},P={critical:4,major:3,maintenance:2,minor:1,none:0},T=e=>Object.keys(P).includes(e),F={investigating:4,identified:3,monitoring:2,resolved:1},z=e=>Object.keys(F).includes(e);var D=e.i(17203);let L="Follow the status page for updates.";function $({isActive:e}){let{data:t,isLoading:s,isError:a}=x();if(s||a||!t||0===t.length)return null;let{hasMultipleIncidents:i,mostCriticalIncident:n,overallStatus:o,allSameStatus:c}=function(e){let t;if(0===e.length)return{hasMultipleIncidents:!1,mostCriticalIncident:null,overallStatus:"investigating",allSameStatus:!0};let s=e.length>1,r=((t=[...e]).sort((e,t)=>{let s=T(e.impact)?e.impact:"none",r=T(t.impact)?t.impact:"none",a=P[s],i=P[r],n=new Date(e.active_since).getTime(),l=new Date(t.active_since).getTime(),o=Number.isFinite(n)&&Number.isFinite(l)&&l!==n,c=z(e.status)?e.status:"investigating",u=z(t.status)?t.status:"investigating",d=F[c],h=F[u];return i!==a?i-a:o?l-n:h-d}),t)[0],a=z(r.status)?r.status:"investigating";return{hasMultipleIncidents:s,mostCriticalIncident:r,overallStatus:a,allSameStatus:function(e){if(e.length<=1)return!0;let t=e[0].status;return e.every(e=>e.status===t)}(e)}}(t),u=(n?.name??"")+(i?` and ${t.length-1} other issue${t.length>2?"s":""}`:"");return(0,r.jsx)(R.AnimatePresence,{children:e&&(0,r.jsx)(w.motion.aside,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,r.jsx)(_.Admonition,{type:"warning",layout:"horizontal",title:u,description:((e,t,s)=>{let r=t?"these issues":"this issue";switch(e){case"investigating":if(t&&!s)return`We are aware of multiple ongoing issues and are investigating. ${L}`;return`We are investigating ${r}. ${L}`;case"identified":if(t&&!s)return`We have identified the cause of some of ${r} and are working on fixes. ${L}`;return`We have identified the cause of ${r} and are working on a fix. ${L}`;case"monitoring":if(t&&!s)return`Fixes have been deployed for some of ${r} and we are monitoring the results. ${L}`;return`A fix has been deployed and we are monitoring the results. ${L}`;case"resolved":if(t&&!s)return`Some of ${r} have been resolved, but others may still be ongoing. ${L}`;return`${r.charAt(0).toUpperCase()+r.slice(1)} ${t?"have":"has"} been resolved but may take some time to fully recover. ${L}`;default:return`We are investigating ${r}. ${L}`}})(o,i,c),actions:(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(D.ExternalLink,{strokeWidth:1.5}),children:(0,r.jsx)(l.default,{href:"https://status.supabase.com/",target:"_blank",rel:"noreferrer",children:"Status page"})})})})})}var M=e.i(164045),U=e.i(432478),B=e.i(370410),G=e.i(906346),K=e.i(795019),W=e.i(479095),V=A;let H=({sentCategory:e="",selectedProject:t=V.NO_PROJECT_MARKER})=>{let{profile:s}=(0,U.useProfile)(),a=s?.primary_email??"your email",{data:i}=(0,M.useProjectDetailQuery)({ref:t},{enabled:t!==V.NO_PROJECT_MARKER}),n=i?i.name:"No specific project";return(0,r.jsxs)("div",{className:"mt-10 max-w-[620px] flex flex-col items-center space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(G.Mail,{strokeWidth:1.5,size:60,className:"text-brand"}),(0,r.jsx)("div",{className:"h-6 w-6 rounded-full bg-brand absolute bottom-1 -right-1.5 flex items-center justify-center",children:(0,r.jsx)(B.Check,{strokeWidth:4,size:16,className:"text-contrast"})})]}),(0,r.jsxs)("div",{className:"flex items-center flex-col space-y-2 text-center p-4",children:[(0,r.jsx)("h3",{className:"text-xl",children:"Support request sent"}),(0,r.jsxs)("p",{className:"text-sm text-foreground-light text-balance",children:[t!==V.NO_PROJECT_MARKER&&(0,r.jsxs)(r.Fragment,{children:["Your ticket has been logged for the project"," ",(0,r.jsx)("span",{className:"text-foreground font-medium",children:n})," with project ID:"," ",(0,r.jsx)("span",{className:"text-foreground font-medium",children:t}),"."]})," ","We will reach out to you at"," ",(0,r.jsx)("span",{className:"text-foreground font-medium",children:a}),"."]})]}),["Problem","Unresponsive","Performance"].includes(e)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"!my-10 w-full",children:(0,r.jsx)(W.Separator,{})}),(0,r.jsxs)("div",{className:"flex flex-col items-center px-12 space-y-2 text-center",children:[(0,r.jsx)("h4",{className:"text-lg font-normal",children:"Tap into our community"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light text-balance",children:"Our Discord community can help with code-related issues. Many questions are answered in minutes."})]}),(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(K.IconDiscord,{size:16,fill:"hsl(var(--background-default))"}),children:(0,r.jsx)(l.default,{href:"https://discord.supabase.com/",target:"_blank",children:"Join us on Discord"})})]}),(0,r.jsx)("div",{className:"!mt-10 w-full",children:(0,r.jsx)(W.Separator,{})}),(0,r.jsx)("div",{className:"w-full pb-4 px-4 flex items-center justify-end",children:(0,r.jsx)(S.Button,{asChild:!0,type:"default",children:(0,r.jsx)(l.default,{href:"/",children:"Finish"})})})]})};var q=e.i(48189);function J(){return{type:"initializing"}}function Q(e,t){switch(e.type){case"initializing":if("INITIALIZE"===t.type)return{type:"editing"};return console.warn(`[SupportForm > supportFormReducer] ${t.type} action not allowed in 'initializing' state`),e;case"editing":if("SUBMIT"===t.type)return{type:"submitting"};return console.warn(`[SupportForm > supportFromReducer] ${t.type} action not allowed in 'filling_out' state`),e;case"submitting":if("SUCCESS"===t.type)return{type:"success",sentProjectRef:t.sentProjectRef,sentOrgSlug:t.sentOrgSlug,sentCategory:t.sentCategory};if("ERROR"===t.type)return{type:"error",message:t.message};return console.warn(`[SupportForm > supportFormReducer] ${t.type} action not allowed in 'submitting' state`),e;case"success":return console.warn(`[SupportForm > supportFormReducer] ${t.type} allowed in 'success' state`),e;case"error":if("RETURN_TO_EDITING"===t.type)return{type:"editing"};return console.warn(`[SupportForm > supportFormReducer] ${t.type} allowed in 'success' state`),e;default:return(0,q.neverGuard)(e)}}var X=e.i(902858);e.i(128328);var Y=e.i(298650),Z=e.i(657588);e.i(688894);var ee=e.i(24970),et=e.i(14703),es=e.i(97891),er=e.i(210801),ea=e.i(973601),ei=e.i(253214),en=e.i(428353),el=e.i(24315),eo=e.i(61863),ec=e.i(538482),eu=e.i(297396),ed=e.i(177113);let eh=[X.SupportCategories.LOGIN_ISSUES,"Plan_upgrade"];function ep({form:e,category:t}){return eh.includes(t)?null:(0,r.jsx)(eo.FormField_Shadcn_,{name:"affectedServices",control:e.control,render:({field:t})=>(0,r.jsx)(ec.FormItemLayout,{hideMessage:!0,layout:"vertical",label:"Which services are affected?",children:(0,r.jsx)(el.FormControl_Shadcn_,{children:(0,r.jsx)(eu.MultiSelectV2,{options:ed.SERVICE_OPTIONS,value:0===t.value.length?[]:t.value?.split(", "),placeholder:"No particular service",searchPlaceholder:"Search for a service",onChange:t=>e.setValue("affectedServices",t.join(", "))})})})})}var eg=e.i(738961),em=e.i(479232),ex=e.i(975924),ef=e.i(2824);let ej=async({userId:e,files:t})=>{let s=(0,ef.createSupportStorageClient)(),r=Array.from(t),a=await Promise.all(r.map(async t=>{let r=t.type.split("/")[1],a=`${e}/${(0,q.uuidv4)()}.${r}`,{data:i,error:n}=await s.storage.from("support-attachments").upload(a,t,{cacheControl:"3600"});return n&&console.error("Failed to upload:",t.name,n),i}));return(0,eg.default)(a).map(e=>e.path)};function ey({uploadButtonRef:e,isFull:t,uploadedDataUrls:s,addFile:a,handleFileUpload:i,removeFileUpload:n}){let{profile:l}=(0,U.useProfile)();return l?(0,r.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Attachments"}),(0,r.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Upload up to ",5," screenshots that might be relevant to the issue that you're facing"]})]}),(0,r.jsx)("input",{multiple:!0,type:"file",ref:e,className:"hidden",accept:"image/png, image/jpeg",onChange:i}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[s.map((e,t)=>(0,r.jsx)("div",{style:{backgroundImage:`url("${e}")`},className:"relative h-14 w-14 rounded bg-cover bg-center bg-no-repeat",children:(0,r.jsx)("button",{type:"button","aria-label":"Remove attachment",className:(0,v.cn)("flex h-4 w-4 items-center justify-center rounded-full bg-red-900","absolute -top-1 -right-1 cursor-pointer"),onClick:()=>n(t),children:(0,r.jsx)(ex.X,{"aria-hidden":"true",size:12,strokeWidth:2})})},e)),!t&&(0,r.jsx)("button",{type:"button",className:(0,v.cn)("border border-stronger opacity-50 transition hover:opacity-100","group flex h-14 w-14 cursor-pointer items-center justify-center rounded"),onClick:a,children:(0,r.jsx)(em.Plus,{strokeWidth:2,size:20})})]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm text-foreground",children:"Attachments"}),(0,r.jsx)("p",{className:"text-sm text-foreground-lighter mt-2",children:"Uploads are only supported when logged in. Please reply to the acknowledgement email you will receive with any screenshots you'd like to upload."})]})}var eb=e.i(750824),eS=e.i(912793),ev=e.i(449123),eN=e.i(451031),e_=e.i(57492),eR=e.i(831927),ew=e.i(156722),eC=e.i(719754);function eE({form:e,category:t,library:s}){return(0,eS.useIsFeatureEnabled)("support:show_client_libraries")&&"Problem"===t?(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsx)(eo.FormField_Shadcn_,{name:"library",control:e.control,render:({field:e})=>(0,r.jsx)(ec.FormItemLayout,{layout:"vertical",label:"Which library are you having issues with",children:(0,r.jsx)(el.FormControl_Shadcn_,{children:(0,r.jsxs)(ev.Select_Shadcn_,{...e,defaultValue:e.value,onValueChange:e.onChange,children:[(0,r.jsx)(ew.SelectTrigger_Shadcn_,{className:"w-full","aria-label":"Select a library",children:(0,r.jsx)(eC.SelectValue_Shadcn_,{placeholder:"Select a library"})}),(0,r.jsx)(eN.SelectContent_Shadcn_,{children:(0,r.jsx)(e_.SelectGroup_Shadcn_,{children:ee.CLIENT_LIBRARIES.map(e=>(0,r.jsx)(eR.SelectItem_Shadcn_,{value:e.language,children:e.language},e.language))})})]})})})}),s&&s.length>0&&(0,r.jsx)(eA,{library:s})]}):null}let eA=({library:e})=>{let t=ee.CLIENT_LIBRARIES.find(t=>t.language===e),s=t?.libraries.filter(e=>e.name.includes("supabase-"));return(0,r.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Found an issue or a bug? Try searching our GitHub issues or submit a new one."})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 overflow-x-auto",children:[s?.map(t=>{let s="Dart (Flutter)"===e?t.name.split("-")[1]:e;return(0,r.jsxs)("div",{className:"w-[230px] min-w-[230px] min-h-[128px] rounded border border-control bg-surface-100 space-y-3 px-4 py-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm",children:t.name}),(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["For issues regarding the ",s," client library"]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(D.ExternalLink,{size:14,strokeWidth:1.5}),children:(0,r.jsx)(l.default,{href:t.url,target:"_blank",rel:"noreferrer",children:"View GitHub issues"})})})]},t.name)}),(0,r.jsxs)("div",{className:(0,v.cn)("px-4 py-3 rounded border border-control bg-surface-100","w-[230px] min-w-[230px] min-h-[128px] flex flex-col justify-between space-y-3"),children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm",children:"supabase"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"For any issues about our API"})]}),(0,r.jsx)("div",{children:(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(D.ExternalLink,{size:14,strokeWidth:1.5}),children:(0,r.jsx)(l.default,{href:"https://github.com/supabase/supabase",target:"_blank",rel:"noreferrer",children:"View GitHub issues"})})})]})]})]})};var eI=e.i(416050),eO=e.i(925282),ek=e.i(774234),eP=e.i(554855),eT=e.i(290811),eF=e.i(870188),ez=e.i(672296);let eD="dashboard-logs",eL=[X.SupportCategories.DASHBOARD_BUG],e$=()=>{let e=(0,eF.getOwnershipOfBreadcrumbSnapshot)()??(0,eF.getMirroredBreadcrumbs)();return(0,ez.sanitizeArrayOfObjects)(e)},eM=async({userId:e,sanitizedLogs:t,uploadDashboardLogFn:s})=>{if(!e)return console.error("[SupportForm > uploadDashboardLog] Cannot upload dashboard log: user ID is undefined"),[];if(0===t.length)return[];try{let r=(0,ef.createSupportStorageClient)(),a=`${e}/${(0,q.uuidv4)()}.json`,i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),{error:n}=await r.storage.from(eD).upload(a,i,{cacheControl:"3600",contentType:"application/json",upsert:!1});if(n)return console.error("[SupportForm > uploadDashboardLog] Failed to upload dashboard log to support storage bucket",n),[];return s({bucket:eD,filenames:[a]})}catch(e){return console.error("[SupportForm] Unexpected error uploading dashboard log",e),[]}};function eU({form:e,sanitizedLog:t}){let s=(0,o.useMemo)(()=>JSON.stringify(t,null,2),[t]),[a,i]=(0,o.useState)(!1);if(eL.includes(e.getValues("category")))return(0,r.jsx)(eo.FormField_Shadcn_,{name:"attachDashboardLogs",control:e.control,render:({field:e})=>(0,r.jsx)(ec.FormItemLayout,{hideMessage:!0,name:"attachDashboardLogs",className:"px-6",layout:"flex",label:(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)("span",{className:"text-foreground",children:"Include dashboard activity log"})}),description:(0,r.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,r.jsx)("span",{className:"text-foreground-light",children:"Share sanitized logs of recent dashboard actions to help reproduce the issue."}),(0,r.jsxs)(eO.Collapsible_Shadcn_,{open:a,onOpenChange:i,children:[(0,r.jsxs)(eP.CollapsibleTrigger_Shadcn_,{className:"group flex items-center gap-x-1 text-sm text-foreground-lighter hover:text-foreground transition",children:[(0,r.jsx)(eI.ChevronRight,{size:14,className:"transition-transform group-data-[state=open]:rotate-90"}),(0,r.jsx)("span",{children:"Preview log"})]}),(0,r.jsx)(ek.CollapsibleContent_Shadcn_,{className:"mt-2",children:(0,r.jsx)("pre",{className:"bg-background-surface-200 border border-strong rounded-lg p-3 max-h-60 overflow-y-auto overflow-x-auto text-xs text-foreground-light whitespace-pre-wrap",children:s})})]})]}),children:(0,r.jsx)(eT.Switch,{size:"large",id:"attachDashboardLogs",checked:e.value,onCheckedChange:e.onChange})})})}var eB=e.i(398876),eG=e.i(382490),eK=e.i(178527),eW=e.i(206413),eV=e.i(592360);let eH=()=>(0,r.jsxs)(eK.Alert_Shadcn_,{variant:"default",children:[(0,r.jsx)(eG.HelpCircle,{strokeWidth:2}),(0,r.jsx)(eV.AlertTitle_Shadcn_,{children:"Connection issues?"}),(0,r.jsxs)(eW.AlertDescription_Shadcn_,{className:"grid gap-3",children:[(0,r.jsx)("p",{children:"Having trouble connecting to your project? It could be related to our migration from PGBouncer and IPv4."}),(0,r.jsx)("p",{children:"Please review this GitHub discussion. It's up to date and covers many frequently asked questions."}),(0,r.jsx)("p",{children:(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(D.ExternalLink,{strokeWidth:1.5}),children:(0,r.jsx)(l.default,{target:"_blank",rel:"noreferrer",href:"https://github.com/orgs/supabase/discussions/17817",children:"PGBouncer and IPv4 Deprecation #17817"})})})]})]});function eq({form:e,originalError:t}){return(0,r.jsx)(eo.FormField_Shadcn_,{name:"message",control:e.control,render:({field:e})=>(0,r.jsxs)(ec.FormItemLayout,{layout:"vertical",label:"Message",labelOptional:"5000 character limit",description:ed.IPV4_MIGRATION_STRINGS.some(t=>e.value.includes(t))&&(0,r.jsx)(eH,{}),children:[(0,r.jsx)(el.FormControl_Shadcn_,{children:(0,r.jsx)(eB.TextArea_Shadcn_,{...e,rows:4,maxLength:5e3,placeholder:"Describe the issue youâ€™re facing, along with any relevant information. Please be as detailed and specific as possible."})}),t&&(0,r.jsx)(_.Admonition,{showIcon:!1,type:"default",className:"mt-2 max-h-[150px] overflow-y-auto",title:"The error that you ran into will be included in your message for reference",description:`Error: ${t}`})]})})}var eJ=e.i(604594),eQ=e.i(768989),eX=e.i(378277),eY=e.i(636900),eZ=e.i(398696),e0=e.i(727095),e1=e.i(867467);function e2({searchString:e}){let t=function(e){let{handleDocsSearchDebounced:t,resetSearch:s,searchState:r}=(0,e0.useDocsSearch)(),a=e.trim(),i=(0,e1.useChangedSync)(a);return i&&a?t(a):i&&!a&&s(),r}(e),s="results"in t?t.results:"staleResults"in t?t.staleResults:[],a="loading"===t.status;return(0,r.jsxs)(r.Fragment,{children:["loading"===t.status&&(0,r.jsx)(e4,{}),s.length>0&&(0,r.jsx)(e8,{results:s,isStale:a})]})}function e4(){return(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-foreground-light",children:[(0,r.jsx)(i.Loader2,{className:"animate-spin",size:14}),(0,r.jsx)("span",{children:"Searching for relevant resources..."})]})}function e8({results:e,isStale:t}){return(0,r.jsx)("ul",{className:(0,v.cn)("flex flex-col gap-y-0.5 transition-opacity duration-200",t?"opacity-50":"opacity-100"),children:e.slice(0,5).map(e=>(0,r.jsxs)("li",{className:"flex items-center gap-x-1",children:["github-discussions"===e.type?(0,r.jsx)(eZ.Github,{size:16,className:"text-foreground-muted"}):(0,r.jsx)(eY.Book,{size:16,className:"text-foreground-muted"}),(0,r.jsx)("a",{href:"github-discussions"===e.type?e.path:`${g.DOCS_URL}${e.path}`,target:"_blank",rel:"noreferrer",className:"text-sm text-foreground-light hover:text-foreground transition",children:e.title})]},e.id))})}let e3=[X.SupportCategories.DATABASE_UNRESPONSIVE,X.SupportCategories.PROBLEM];function e5({form:e,category:t,subject:s}){return(0,r.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,r.jsx)(eo.FormField_Shadcn_,{name:"subject",control:e.control,render:({field:e})=>(0,r.jsx)(ec.FormItemLayout,{layout:"vertical",label:"Subject",children:(0,r.jsx)(el.FormControl_Shadcn_,{children:(0,r.jsx)(eX.Input_Shadcn_,{...e,placeholder:"Summary of the problem you have"})})})}),(0,r.jsx)(e2,{searchString:s}),s&&e3.includes(t)&&(0,r.jsx)(e7,{subject:s})]})}function e7({subject:e}){return(0,r.jsxs)("p",{className:"flex items-center gap-x-1 text-foreground-lighter text-sm",children:["Check our",(0,r.jsxs)(l.default,{href:`https://github.com/orgs/supabase/discussions?discussions_q=${e}`,target:"_blank",rel:"noreferrer",className:"flex items-center gap-x-1 underline hover:text-foreground transition",children:["GitHub discussions",(0,r.jsx)(D.ExternalLink,{size:14,strokeWidth:2})]},"gh-discussions"),"for a quick answer"]})}function e9({isSubmitting:e,userEmail:t,onClick:s}){return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(S.Button,{htmlType:"submit",size:"small",block:!0,disabled:e,loading:e,onClick:s,children:"Send support request"}),(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter text-balance pr-4",children:["We will contact you at ",(0,r.jsx)("span",{className:"text-foreground font-medium",children:t}),". Please ensure emails from supabase.com are allowed."]})]})}var e6=e.i(184028);let te=({form:e,initialError:t,state:s,dispatch:a})=>{let i,{profile:n}=(0,U.useProfile)(),l=n?.primary_email??"your email",{organizationSlug:c,projectRef:d,category:p,severity:g,subject:m,library:x}=e.watch(),f=c===A.NO_ORG_MARKER?null:c,j=d===A.NO_PROJECT_MARKER?null:d,{data:y}=(0,h.useOrganizationsQuery)(),b=(0,A.getOrgSubscriptionPlan)(y,f),S=(i=(0,Z.useFlag)("simplifiedSupportForm"),"platform"===b||"string"==typeof i&&i.split(",").map(e=>e.trim()).includes(c)),v=function(){let{profile:e}=(0,U.useProfile)(),t=(0,o.useRef)(null),[s,r]=(0,o.useState)([]),[a,i]=(0,o.useState)([]),{mutateAsync:n}=(0,er.useGenerateAttachmentURLsMutation)(),l=s.length>=5,c=(0,o.useCallback)(()=>{t.current?.click()},[]),d=(0,o.useCallback)(async e=>{e.persist();let t=e.target.files||e.dataTransfer.items,a=Array.prototype.map.call(t,e=>e).slice(0,5-s.length);r(s.concat(a)),t.length+s.length>5&&(0,u.toast)("Only up to 5 attachments are allowed"),e.target.value=""},[s]),h=(0,o.useCallback)(e=>{let t=s.slice();t.splice(e,1),r(t);let n=a.slice();a.splice(e,1),i(n)},[s,a]);(0,o.useEffect)(()=>{if(!s)return;let e=s.map(e=>URL.createObjectURL(e));return i(e),()=>{e.forEach(e=>void URL.revokeObjectURL(e))}},[s]);let p=(0,o.useCallback)(async()=>{if(!e?.id)return console.error("[Support Form > uploadAttachments] Unable to upload files, missing user ID"),u.toast.error("Unable to upload attachments"),[];if(0===s.length)return;let t=await ej({userId:e.gotrue_id,files:s});return await n({bucket:"support-attachments",filenames:t})},[e,s]);return(0,o.useMemo)(()=>({uploadButtonRef:t,isFull:l,addFile:c,handleFileUpload:d,removeFileUpload:h,createAttachments:p,uploadedDataUrls:a}),[l,c,d,h,p,a])}(),{mutateAsync:N}=(0,er.useGenerateAttachmentURLsMutation)(),_=(0,Y.useConstant)(e$),{data:R}=(0,ea.useDeploymentCommitQuery)({staleTime:6e5}),{mutate:w}=(0,es.useSendSupportTicketMutation)({onSuccess:(e,t)=>{a({type:"SUCCESS",sentProjectRef:t.projectRef,sentOrgSlug:t.organizationSlug,sentCategory:t.category})},onError:e=>{a({type:"ERROR",message:e.message})}}),C=async e=>{a({type:"SUBMIT"});let{attachDashboardLogs:s,...r}=e,i=s&&eL.includes(r.category),[l,o]=await Promise.all([v.createAttachments(),i?eM({userId:n?.gotrue_id,sanitizedLogs:_,uploadDashboardLogFn:N}):void 0]),c=r.library?ee.CLIENT_LIBRARIES.find(e=>e.language===r.library):void 0,u={...r,category:p,organizationSlug:r.organizationSlug??A.NO_ORG_MARKER,projectRef:r.projectRef??A.NO_PROJECT_MARKER,allowSupportAccess:!!e6.SUPPORT_ACCESS_CATEGORIES.includes(r.category)&&r.allowSupportAccess,library:r.category===X.SupportCategories.PROBLEM&&void 0!==c?c.key:"",message:(0,A.formatMessage)({message:r.message,attachments:l,error:t,commit:R,dashboardLogUrl:o?.[0]}),verified:!0,tags:["dashboard-support-form"],siteUrl:"",additionalRedirectUrls:"",affectedServices:eh.includes(r.category)?"":r.affectedServices.split(",").map(e=>e.trim().replace(/ /g,"_").toLowerCase()).join(";"),browserInformation:(0,q.detectBrowser)()};if(r.projectRef!==A.NO_PROJECT_MARKER)try{let e=await (0,et.getProjectAuthConfig)({projectRef:r.projectRef});u.siteUrl=e.SITE_URL,u.additionalRedirectUrls=e.URI_ALLOW_LIST}catch{}w(u)},E=e.handleSubmit(C);return(0,o.useEffect)(()=>{S?e.setValue("category","Others"):e.setValue("category","")},[S]),(0,r.jsx)(en.Form_Shadcn_,{...e,children:(0,r.jsxs)("form",{id:"support-form",className:"flex flex-col gap-y-6",children:[(0,r.jsx)("h3",{className:"px-6 text-xl",children:"How can we help?"}),(0,r.jsxs)("div",{className:"px-6 flex flex-col gap-y-8",children:[(0,r.jsx)(eJ.OrganizationSelector,{form:e,orgSlug:c}),(0,r.jsx)(eQ.ProjectAndPlanInfo,{form:e,orgSlug:f,projectRef:j,subscriptionPlanId:b,category:p}),!S&&(0,r.jsx)(eb.CategoryAndSeverityInfo,{form:e,category:p,severity:g,projectRef:d})]}),(0,r.jsx)(ei.DialogSectionSeparator,{}),(0,r.jsxs)("div",{className:"px-6 flex flex-col gap-y-8",children:[(0,r.jsx)(e5,{form:e,subject:m,category:p}),!S&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eE,{form:e,library:x,category:p}),(0,r.jsx)(ep,{form:e,category:p})]}),(0,r.jsx)(eq,{form:e,originalError:t}),(0,r.jsx)(ey,{...v})]}),(0,r.jsx)(ei.DialogSectionSeparator,{}),eL.includes(p)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eU,{form:e,sanitizedLog:_}),(0,r.jsx)(ei.DialogSectionSeparator,{})]}),e6.SUPPORT_ACCESS_CATEGORIES.includes(p)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e6.SupportAccessToggle,{form:e}),(0,r.jsx)(ei.DialogSectionSeparator,{})]}),(0,r.jsx)("div",{className:"px-6 pt-2",children:(0,r.jsx)(e9,{isSubmitting:"submitting"===s.type,userEmail:l,onClick:e=>{E(e)}})})]})})};var tt=e.i(532728),ts=e.i(408891),tr=e.i(97429),ta=e.i(67818),ti=e.i(794231);let tn=(s=(0,ta.isFeatureEnabled)("support:show_client_libraries"),t=tr.z.object({organizationSlug:tr.z.string().min(1,"Please select an organization"),projectRef:tr.z.string().min(1,"Please select a project"),category:tr.z.enum(ed.CATEGORY_OPTIONS.map(e=>e.value)),severity:tr.z.string(),library:tr.z.string(),subject:tr.z.string().min(1,"Please add a subject heading"),message:tr.z.string().min(1,"Please add a message about the issue that you're facing"),affectedServices:tr.z.string(),allowSupportAccess:tr.z.boolean(),attachDashboardLogs:tr.z.boolean(),dashboardSentryIssueId:tr.z.string().optional()}),s?t.refine(e=>"Problem"!==e.category||""!==e.library,{message:"Please select the library that you're facing issues with",path:["library"]}).refine(e=>!e.message.includes(ti.PLAN_REQUEST_EMPTY_PLACEHOLDER),{message:"Please let us know which plan you'd like to upgrade to for your organization",path:["message"]}):t.extend({library:tr.z.string().optional()}).refine(e=>!e.message.includes(ti.PLAN_REQUEST_EMPTY_PLACEHOLDER),{message:"Please let us know which plan you'd like to upgrade to for your organization",path:["message"]})),tl={organizationSlug:A.NO_ORG_MARKER,projectRef:A.NO_PROJECT_MARKER,severity:"Low",category:void 0,library:"",subject:"",message:"",affectedServices:"",allowSupportAccess:!0,attachDashboardLogs:!0,dashboardSentryIssueId:""};function to(){return(0,r.jsx)(tc,{})}function tc(){let{data:e}=(0,h.useOrganizationsQuery)(),[t,s]=(0,o.useReducer)(Q,void 0,J),{form:i,initialError:n,projectRef:l,orgSlug:c}=function(e){let t=(0,ts.useForm)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,tt.zodResolver)(tn),defaultValues:tl}),s=(0,o.useRef)(null),[r,a]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=(0,A.loadSupportFormInitialParams)(window.location.search);s.current=e,a(e.error??null),e.category&&!t.getFieldState("category").isDirty&&t.setValue("category",e.category,{shouldDirty:!1}),"string"!=typeof e.subject||t.getFieldState("subject").isDirty||t.setValue("subject",e.subject,{shouldDirty:!1}),"string"!=typeof e.message||t.getFieldState("message").isDirty||t.setValue("message",e.message,{shouldDirty:!1}),e.sid&&!t.getFieldState("dashboardSentryIssueId").isDirty&&t.setValue("dashboardSentryIssueId",e.sid,{shouldDirty:!1})},[t]);let i=(0,o.useRef)(!1),{data:n,isPending:l}=(0,h.useOrganizationsQuery)();(0,o.useEffect)(()=>{if(i.current||!s.current||l)return;i.current=!0;let r=s.current.orgSlug&&s.current.orgSlug!==A.NO_ORG_MARKER?s.current.orgSlug:null,a=s.current.projectRef??null;(0,A.selectInitialOrgAndProject)({projectRef:a,orgSlug:r,orgs:n??[]}).then(({orgSlug:e,projectRef:s})=>{t.getFieldState("organizationSlug").isDirty||t.setValue("organizationSlug",e??A.NO_ORG_MARKER,{shouldDirty:!1}),t.getFieldState("projectRef").isDirty||t.setValue("projectRef",s??A.NO_PROJECT_MARKER,{shouldDirty:!1})}).catch(()=>{}).finally(()=>{e({type:"INITIALIZE",debugSource:"useSupportForm"})})},[n,l,t,e]);let c=(0,ts.useWatch)({control:t.control,name:"projectRef"}),u=(0,ts.useWatch)({control:t.control,name:"organizationSlug"});return{form:t,initialError:r,projectRef:c&&c!==A.NO_PROJECT_MARKER?c:null,orgSlug:u&&u!==A.NO_ORG_MARKER?u:null}}(s),d=e?.find(e=>e.slug===c);d?.plan.id;let{data:p,isPending:g,isError:m}=x(),f=!g&&!m&&p&&p.length>0,j=function(){let{mutate:e}=(0,y.useSendEventMutation)();return(0,o.useCallback)(({projectRef:t,orgSlug:s,category:r})=>e({action:"support_ticket_submitted",properties:{ticketCategory:r},groups:{project:t,organization:s}}),[e])}();b(t,"submitting","success",(e,t)=>{u.toast.success("Support request sent. Thank you!"),j({projectRef:t.sentProjectRef,orgSlug:t.sentOrgSlug,category:t.sentCategory})}),b(t,"submitting","error",(e,t)=>{u.toast.error(`Failed to submit support ticket: ${t.message}`),a.captureMessage(`Failed to submit Support Form: ${t.message}`),s({type:"RETURN_TO_EDITING"})});let S="success"===t.type;return(0,r.jsxs)(tu,{children:[(0,r.jsx)(td,{}),(0,r.jsx)($,{isActive:f}),!S&&!f&&(0,r.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,r.jsx)(I,{projectRef:l,organizationSlug:c}),(0,r.jsx)(k,{organizationSlug:c})]}),(0,r.jsx)(tp,{form:i,state:t,dispatch:s,initialError:n,selectedProjectRef:l}),!S&&(0,r.jsx)(th,{projectRef:l})]})}function tu({children:e}){return(0,r.jsx)("div",{className:"relative overflow-y-auto overflow-x-hidden",children:(0,r.jsx)("div",{className:"mx-auto my-16 max-w-2xl w-full px-4 lg:px-6",children:(0,r.jsx)("div",{className:"flex flex-col gap-y-8",children:e})})})}function td(){let{data:e,isPending:t,isError:s}=((e={})=>(0,p.useQuery)({queryKey:["platform","status"],queryFn:({signal:e})=>j(e),...e}))(),a=e?.isHealthy;return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(c.default,{src:`${g.BASE_PATH}/img/supabase-logo.svg`,className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"m-0 text-lg",children:"Supabase support"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:(0,r.jsx)(n.Wrench,{}),children:(0,r.jsx)(l.default,{href:`${g.DOCS_URL}/guides/troubleshooting?products=platform`,target:"_blank",rel:"noreferrer",children:"Troubleshooting"})}),(0,r.jsxs)(N.Tooltip,{children:[(0,r.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,r.jsx)(S.Button,{asChild:!0,type:"default",icon:t?(0,r.jsx)(i.Loader2,{className:"animate-spin"}):a?(0,r.jsx)("div",{className:"h-2 w-2 bg-brand rounded-full"}):(0,r.jsx)("div",{className:"h-2 w-2 bg-yellow-900 rounded-full"}),children:(0,r.jsx)(l.default,{href:"https://status.supabase.com/",target:"_blank",rel:"noreferrer",children:t?"Checking status":s?"Failed to check status":a?"All systems operational":"Active incident ongoing"})})}),(0,r.jsx)(N.TooltipContent,{side:"bottom",align:"center",children:"Check the Supabase status page"})]})]})]})}function th({projectRef:e}){let t=e&&e!==A.NO_PROJECT_MARKER;return(0,r.jsx)(_.Admonition,{type:"default",title:"Having trouble submitting the form?",description:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"!mb-2.5",children:"Please email us directly. Include your project ID and as much information as possible."}),(0,r.jsxs)("p",{className:"flex items-center gap-x-1.5 flex-wrap",children:["Email:"," ",(0,r.jsxs)("span",{className:"inline-flex items-center gap-x-1",children:[(0,r.jsx)("a",{href:`mailto:support@supabase.com?subject=${encodeURIComponent("Support Request")}${t?`${encodeURIComponent(" for Project ID: ")}${encodeURIComponent(e)}`:""}&body=${encodeURIComponent("Here is a detailed description of the problem I am experiencing and any other information that might be helpful...")}`,className:"hover:text-foreground transition-colors duration-100",children:(0,r.jsx)("code",{className:"text-code-inline !text-foreground-light underline decoration-foreground-lighter/50 hover:decoration-foreground-lighter/80 transition-colors duration-100",children:"support@supabase.com"})}),(0,r.jsx)(d.default,{type:"text",text:"support@supabase.com",iconOnly:!0,onClick:()=>u.toast.success("Copied email address to clipboard")})]})]}),t&&(0,r.jsxs)("p",{className:"flex items-center gap-x-1.5 flex-wrap",children:["Project ID:"," ",(0,r.jsxs)("span",{className:"inline-flex items-center gap-x-1",children:[(0,r.jsx)("code",{className:"text-code-inline !text-foreground-light",children:e}),(0,r.jsx)(d.default,{iconOnly:!0,type:"text",text:e,onClick:()=>u.toast.success("Copied project ID to clipboard")})]})]})]})})}function tp({form:e,state:t,dispatch:s,initialError:a,selectedProjectRef:i}){let n="success"===t.type;return(0,r.jsx)("div",{className:(0,v.cn)("min-w-full w-full space-y-12 rounded border bg-panel-body-light shadow-md",`${n?"pt-8":"py-8"}`,"border-default"),children:n?(0,r.jsx)(H,{selectedProject:i??void 0,sentCategory:t.sentCategory}):(0,r.jsx)(te,{form:e,initialError:a,state:t,dispatch:s})})}var tg=e.i(467601),tm=e.i(448710),tx=e.i(951138);let tf=()=>(0,r.jsx)(to,{});tf.getLayout=e=>(0,r.jsx)(tg.default,{children:(0,r.jsx)(tm.default,{children:e})});let tj=(0,tx.withAuth)(tf,{useHighestAAL:!1});e.s(["default",0,tj],958803)},329734,(e,t,s)=>{let r="/support/new";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(958803)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})}]);

//# debugId=1b329996-145e-e618-a657-c7c893e22f3c
//# sourceMappingURL=5915ac879e7ae6d8.js.map